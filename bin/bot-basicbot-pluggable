#!/usr/bin/perl

=head1 NAME

bot-basicbot-pluggable - A standard Bot::BasicBot::Pluggable script

=head1 DESCRIPTION

A standard Bot::BasicBot::Pluggable interface. You can /query the bot to
load in more modules. Change the admin password ASAP - 
See perldoc L<Bot::BasicBot::Pluggable::Auth> for details of this.

=head1 USAGE

  bot-basicbot-pluggable --nick MyBot --server irc.perl.org

=head2 SEE ALSO

Bot::BasicBot::Pluggable

=cut

use warnings;
use strict;
use Bot::BasicBot::Pluggable;
use App::Bot::BasicBot::Pluggable;

my $app = App::Bot::BasicBot::Pluggable->new_with_options();

my $bot = Bot::BasicBot::Pluggable->new(
    channels => $app->channel(),
    server   => $app->server(),
    nick     => $app->nick(),
    charset  => $app->charset(),
    port     => $app->port(),
);

for my $module_name ( @{ $app->module() } ) {
    my $module = $bot->load($module_name);
    if ($app->settings) {
	my %settings = $app->settings;
	if (exists($settings{$module_name})) {
		for my $key (keys %{$settings{$module_name}}) {
			$module->set($key, $settings{$module_name}->{$key});
		}
	}
    }
    if ( $module_name eq 'Auth' and $app->password() ) {
        $module->set( 'password_admin', $app->password() );
    }
}

$bot->run();
